# MADE_CV

# Описание алгоритма получения итогового решения

1) Очистка выборки: была обучена модель pretrained **resnet18** на 10 эпох, посчитаны SE(Squared Errors) на всем трейн датасете, выбраны те наблюдения, ошибка на которых превышала 100 - эти наблюдения оказались с ошибочной разметкой и были удалены из выборки для обучения.
2) Обучение модели pretrained **resnet50** с **MSE** loss'ом 10 эпох, Learning Rate 1e-3
3) Дообучение модели из пункта 2 с **SmoothL1Loss** 5 эпох(примерно, точное число, к сожалению не зафиксировал) и learning rate 1e-3
4) Дообучение модели из пункта 3 с **SmoothL1Loss** 2 эпохи и learning rate 1e-4

Обучал на личном компьютере с 16 Gb RAM, GTX 1660 Ti 6 Gb, **batch-size везде 128** (больше не влазит)

# Пошаговая инструкция запуска скриптов:

1) Распаковать в папку с **data/train** файл **correct_landmarks.pkl**
2) Добавить в папку **data/test** файл **test_points.pkl**
3) Запустить скрипт **hack_train.py** с параметром **epoch 10**
4) В скрипте **hack_train.py** раскомментировать строчку 131 и подать на вход функции **torch.load() .pth файл** с последней эпохи модели из пункта 3.
   Закомментировать 135 строчку и раскомментировать 136.
5) Запустить скрипт **hack_train.py** с параметром **epoch 5**
6) В 131 строчке поменять путь на путь к последнему решению (из пункта 5)
7) Запустить скрипт **hack_train.py** с параметром **epoch 2** и **lr 1e-4**
8) На выходе должно быть 3 submission файла - взять последний.


# Скрин с LB Kaggle
![Image description](https://i.imgur.com/wtJJa3a.png)
